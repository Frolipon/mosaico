extends _layout.jade

block head-content
  meta(name="viewport", content="width=480, initial-scale=1")
  link(rel="stylesheet", href="/badsender-home.css")

block content
  body
    header
      .lang
        if getLocale() === 'en'
          a(href="/?lang=fr") version fran√ßaise
        else
          a(href="/?lang=en") english version

        if (_user.isAdmin)
          | &nbsp;|&nbsp;
          a(href="/admin") admin

        | &nbsp;|&nbsp;
        a(href="/logout")= __('home.logout')

      div: img(src="/media/logo_badsender_154x118.png")
      .ribbon Badsender Email Builder
    main(role="main").content
      p= __('home.click-to-try')
      div
        if !data.wireframes.length
          p no wireframes yet
        else
          each wireframe in data.wireframes
            if (wireframe.hasMarkup)
              .template.template-xx(class="template template-#{name}")
                .description
                  b= wireframe.name
                  span= wireframe.description
                a(href='/editor?wireframeId=' + wireframe._id)
                  img(src=wireframe.imgPath + '_full.png' width="100%" alt="xx")

    if !data.creations.length
      p no saved content
    else
      //- modification du nom directement depuis le tableau
      div.table-container
        table#savedTable
          caption= __('home.saved.caption')
          thead: tr
            th Id
            //- th= __('home.saved.name')
            th= __('home.saved.created')
            th= __('home.saved.last-change')
            th= __('home.saved.operations')
          tbody(data-bind="foreach: edits")
            each creation in data.creations
              - var editUrl = '/editor/' + creation._id;
              tr
                td: a(href=editUrl): code
                  | #
                  span()= creation._id
                //- td: a(href="#")
                //-   span versamix
                td: span= formatDate(creation.createdAt)
                td: span= formatDate(creation.updatedAt)
                td
                  //- ajout d'un bouton dupliquer
                  a.operationButton(href=editUrl title="edit"):  i.fa.fa-pencil
                  a.operationButton(href=editUrl + '/delete' title="delete"): i.fa.fa-trash-o

    footer
      .subscribe
        a(href="http://agency.badsender.com/production/email-builder/")= __('home.more-info')
      .footer
        | Badsender.com -
        |  #{__('home.footer.rights')}
    if _config.debug
      footer(style="background: #eee; text-align: left")
        pre= JSON.stringify(data, null, '  ')
        pre= _debug
