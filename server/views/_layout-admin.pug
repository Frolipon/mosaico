doctype html

block vars

- var page = pageClass || ''
- var title = pageTitle || ''

html(lang=getLocale())
  head
    include _head-material

  body.mdl-color--grey-100.mdl-color-text--grey-700(class=page)
    .mdl-layout.mdl-js-layout.mdl-layout--fixed-header
      header.mdl-layout__header
        .mdl-layout__header-row
          //- Title
          span.mdl-layout-title= title
          //- Add spacer, to align navigation to the right
          .mdl-layout-spacer
          //- Navigation. We hide it in small screens
          nav.mdl-navigation.mdl-layout--large-screen-only
            a.mdl-navigation__link(href="/") mailings
            a.mdl-navigation__link(href="/new-creation") templates
            a.mdl-navigation__link(href="/admin")
              i#nav-companies.material-icons group
              .mdl-tooltip(data-mdl-for="nav-companies") companies
            a.mdl-navigation__link(href="/users")
              i#nav-users.material-icons person
              .mdl-tooltip(data-mdl-for="nav-users") users
            a.mdl-navigation__link(href="/wireframes")
              i#nav-templates.material-icons web
              .mdl-tooltip(data-mdl-for="nav-templates") templates list
            a.mdl-navigation__link(href="/logout")
              i.material-icons power_settings_new

      .mdl-layout__drawer
        span.mdl-layout-title= title
        nav.mdl-navigation
          a.mdl-navigation__link(href="/") mailings
          a.mdl-navigation__link(href="/new-creation") templates
          a.mdl-navigation__link(href="/admin") companies
          a.mdl-navigation__link(href="/users") users
          a.mdl-navigation__link(href="/wireframes") wireframes
          a.mdl-navigation__link(href="/logout") logout


      main.mdl-layout__content(class=page === 'full-width-layout' ? 'mdl-grid mdl-grid--no-spacing' : '' )
        block content
        //- dialog.js-dialog-confirm.mdl-dialog
        //-   h4.mdl-dialog__title.js-dialog-title
        //-   .mdl-dialog__content: p.js-dialog-text
        //-   .mdl-dialog__actions
        //-     button(type="button").js-dialog-confirm.mdl-button.mdl-button--accent.mdl-js-button
        //-     button(type="button").js-dialog-cancel.js-close-rename-dialog.mdl-button
        script.
          (function(){
            //- delete wireframes
            ;(function(){
              var deleteButtons = document.querySelectorAll('.js-delete-wireframe')
              if (!deleteButtons.length) return
              for (var i = 0; i < deleteButtons.length; i++ ) {
                var deleteButton = deleteButtons[ i ]
                deleteButton.addEventListener('click', askWireframeDeletion)
              }
              function askWireframeDeletion(e) {
                var td            = getParent(e.currentTarget, 'tr')
                var wireframeName = td.querySelector('.js-wireframe-name').innerText
                var result        = window.confirm('are you sure you want to delete ' + wireframeName + '?')
                if (result === false ) return e.preventDefault()
              }
            })()
            //- reset user
            ;(function(){
              var resetUsers  = document.querySelectorAll('form.js-reset-user')
              if (!resetUsers.length) return
              for (var i = 0; i < resetUsers.length; i++ ) {
                var resetUser = resetUsers[ i ]
                resetUser.addEventListener('submit', askUserReset)
              }
              function askUserReset(e) {
                var userName  = e.currentTarget.dataset.name
                var result    = window.confirm('are you sure you want to reset ' + userName + ' password?')
                if (result === false ) return e.preventDefault()
              }
            })()
            //- activate user
            ;(function(){
              var activateUsers  = document.querySelectorAll('.js-user-activate')
              if (!activateUsers.length) return
              for (var i = 0; i < activateUsers.length; i++ ) {
                var activateUser = activateUsers[ i ]
                activateUser.addEventListener('click', askUserActivation)
              }
              function askUserActivation(e) {
                var userName  = e.currentTarget.dataset.name
                var result    = window.confirm('are you sure you want to activate ' + userName + '?')
                if (result === false ) return e.preventDefault()
              }
            })()
            //- deactivate user
            ;(function(){
              var deactivateUsers  = document.querySelectorAll('.js-user-deactivate')
              if (!deactivateUsers.length) return
              for (var i = 0; i < deactivateUsers.length; i++ ) {
                var deactivateUser = deactivateUsers[ i ]
                deactivateUser.addEventListener('click', askUserDeactivation)
              }
              function askUserDeactivation(e) {
                var userName  = e.currentTarget.dataset.name
                var result    = window.confirm('are you sure you want to deactivate ' + userName + '?')
                if (result === false ) return e.preventDefault()
              }
            })()
            //- utils
            function getParent( elem, selector ) {
              var parent = false
              for ( ; elem && elem !== document; elem = elem.parentNode ) {
                if ( elem.matches( selector ) ) {
                  parent = elem
                  break
                }
              }
              return parent
            }
          })()

        if _config.debug
          footer(style="background: #eee")
            pre= JSON.stringify(data, null, '  ')
            pre= _debug
